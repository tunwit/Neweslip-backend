import { jwtDecrypt, jwtVerify } from "jose";

const secret = Uint8Array.from(
  Buffer.from("nceYnuJm3YpLlmyxtQdZBBUKY20jx4T+RnqW2aGIlRY=", "base64")
);

export async function verifyJwe(token: string) {
  try {
    // jwtDecrypt decrypts and verifies the token
    const { payload } = await jwtDecrypt(token, secret);

    return payload; // payload is a JS object with your claims
  } catch (error) {
    console.error("Failed to verify/decrypt JWE:", error);
    return null;
  }
}

await verifyJwe(
  "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..kqNniHmLHVqICIwB.QbPVoT5cPCcIRrF8FaBkBd_iujIhlnI7_40mmfa3UdGbSEdX0QumWPi9HUEYBtyZvAIfQXYHHetGJmjZXrnZEiqppi_zlUq59OEHcrQzRFxGK8unYO9-a8EHKTJgBjJlhrSxGpoX6BE1BvHx2MXWJJixxj8Wy6JHwnGGwitfpLb-yK2KENFTkXd6D1v5qYm1o57MzSk7CHh56fzeJUlbqQaHNiCyRDeqkg08arD1k3CS_Ys6aWEB6b2FokYL6d5PsduD8vrnHK9OBBlWK0toxacS-XFyj-H0Xl8vF7OcDk_nyGeqgtLEPKiTiWPj_Nzayqvqu0fYb83l9ININxRCNMhEWU6JvCxeXD5O_21FXCvGGFGto91nGhZhLeUFsgxuxZkEe53LRc1D8qREBWEC9UAOWcYSo94eMvxqNYW3twohbkSqpeC1WJIy0GHsWJefBLaW3ks0CYxpmj0jcOGhDe7WEMFAVOGle8T_aAFoQoWhlSckKgmwWGLBs64WKKKc4by2RnEgb8aVn_0rXXbfoaWpOOnok5yg0xJEA9F2-oV3J1754XFdSoeZO2IXlVWPx4MDCVKIWnDnowPtTKjkMqeGIspy5WMj-Dk0tO8HSIRvV44_cexegvjN9yupqjIk95TaiValvMR-3ajpYbJqYI7jG5L18GGiQtAPXURl_4SkW5MtTrve5WM5khr-oTb-Q36n8c-i6FmQfH12EaxgpDIHW4sBfP6JmbLlC25ygwxGsPWTWR7tyXYwwN_yOmb7B5VLB0z4YOVc2AhdkhPAeiXGz6WWiWDdg50GYzCCZnAv-Vqgs6BDkdMQ_ZTzTLPIsTBAbd4zPAFAZ_OfW2Qsme9QNm3TvfVLMF57OrzNEJmONkGphRq9Rz5bIXDYi-DXhc4l4IUWg99zLpqWl2lWQjia2uz_Db-ur9Nm49HIxNnxNk9a1jkFcV8UEVCRu1O-hCrhxZDsvF-PdwbPi7KVL9L1CRArG6x018QTXoU5A1Z-nkj1KDfKfkaRuxfPEANCMW_IuDldy6u_Gsc1L4Dh6xr8eWvWI2PVoCNUAHTbHQQU5l4pjYHFJTMjXvFo5Jr89J1ohtBkG43ZuIUGP0SbUs8Ltww9j82hywDxujmDL5acOpnqCmqI0ku8Iu0qe3FxU4kmZLzFCDaG36dTDd6VrClQg7ceH8W0tqDT6JrzsrM6gieNuVCXS-8BkDwaIy1wI7DxhT2sMUf-qj6ilfTwEUUaMMltaCkMUU2PWpNxFB_BTE8dClXrfO8TadG_ay-rr9tl80aN_kg-QJGYuNdjQ7B_E0Iu-mG0RYxOYqIIDF-mFNJDqARZDRHFTTfqRwVypqC4gloVlYq8a7W50TdBWG-TsAW2-74HALEtdak6PbXDtT6a2-mRoc0mMBVsk14UZjhsIzlq1DQGS3FONpXqm95qHJ5P6IjeSbE9zbiK-iBYEyqHVdV4AGM6FEFuUoYRECMIWt1WYAQiv5MVHTkFQoFcbOqi8FYSINlqqqNu-Ap2SMETq_asNtecfPNWsjlF63sNZmEWbKl5ee1ss6YwjdcJVpkVxaKqfmPJVE7DgLzt5EoESFIpCWQaM0aOTv4XF7nDi8KPXE7WsWAS4tbDcnUzZlT6f54MClxh4XUIwI0BpwupRdirFJ8Ms0TGo0nrrwAV16-oa_w_Dg-wQBy_YTxL7dZQkyyODCfPJNI933RC_QOL-ktKpSwjPe4yl69u-IS4hTWPV6_OoHbt2Gj9ovJzxdAt_-tTCCQqyMo62VgkvRjx508nA_IErPXCv9GDANfzrB7NzdsVLie2TT8xvuz1RHd8HEVCEUQ2WE6MW9pxT0gX7bj2jFoX4AQW8qUDj3NI6RWM_2SU5ihfEMHFUqFdLiXT4o_O1g8K1mJqk7OXfmGhq8xX1d1bi4KRCw.lpWc3tO82GEXRYxX42aZKg"
);
